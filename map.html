<!DOCTYPE html>
	<html>
		<head>
			<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
			<style type="text/css">
				html { height: 100% }
				body { height: 100%; margin: 0; padding: 0 }
				#map_canvas { height: 100% }
			</style>
			<script type="text/javascript"
				src="http://maps.googleapis.com/maps/api/js?key=AIzaSyDNTwCNSCSK-y65jS8nmaA7qV_PsQeYIJM&sensor=false">
			</script>
			<script type="text/javascript">
			
				var map;
				var i=0;
				var markersArray = [];
				var image;
				var shadow;
				var shape;
				var globalMarker;
				var globalInfoWindow;
				var geocoder;
				function initialize() {
					var coordenadas = new google.maps.LatLng(32.112313,34.801512);
					var myOptions = {
						zoom: 9, 
						center: coordenadas,
						mapTypeId: google.maps.MapTypeId.ROADMAP
					};
              
					image = new google.maps.MarkerImage(
					  'http://i.imgur.com/aL72JbW.png',
					  new google.maps.Size(32,37),
					  new google.maps.Point(0,0),
					  new google.maps.Point(0,37)
					);

					shadow = new google.maps.MarkerImage(
					  'http://i.imgur.com/I5hUYlD.png',
					  new google.maps.Size(54,37),
					  new google.maps.Point(0,0),
					  new google.maps.Point(0,37)
					);
				
					shape = {
					  coord: [29,0,30,1,31,2,31,3,31,4,31,5,31,6,31,7,31,8,31,9,31,10,31,11,31,12,31,13,31,14,31,15,31,16,31,17,31,18,31,19,31,20,31,21,31,22,31,23,31,24,31,25,31,26,31,27,31,28,31,29,30,30,29,31,23,32,22,33,21,34,20,35,19,36,12,36,11,35,10,34,9,33,8,32,2,31,1,30,0,29,0,28,0,27,0,26,0,25,0,24,0,23,0,22,0,21,0,20,0,19,0,18,0,17,0,16,0,15,0,14,0,13,0,12,0,11,0,10,0,9,0,8,0,7,0,6,0,5,0,4,0,3,0,2,1,1,2,0,29,0],
					  type: 'poly'
					};
					
					map = new google.maps.Map(document.getElementById("map_canvas"),
						myOptions);
					geocoder = new google.maps.Geocoder();
					globalInfoWindow = new google.maps.InfoWindow();
					markersArray.push(globalMarker);
					}
				function newMarker(lat,lng,info){  
					var coordenadas = new google.maps.LatLng(lat,lng);
					var marker = new google.maps.Marker({
						icon: image,
						shadow: shadow,
						shape: shape,
						map: map,
						position: coordenadas
					});
					var tempinfo=info;
					markersArray.push(marker);
					var infoWindow = new google.maps.InfoWindow();
					google.maps.event.addListener(marker, 'click', function () {
							map.setZoom(16);
							map.setCenter(marker.getPosition());
							infoWindow.setContent(info);
							infoWindow.open(map, this);
							window.document.title="clicked#"+lat+"#"+lng;
						});
					map.setCenter(coordenadas);
					var n=info.indexOf("<BR/>");
					if(n >=0 )
						tempinfo=info.substring(0,n);
					marker.setTitle(tempinfo);
					setZoom(9);					
				}
				function setCenter(lat,lng){
				var coordenadas = new google.maps.LatLng(lat,lng);
				map.setCenter(coordenadas);
				}
				function clearOverlays() {
  					for (var i = 0; i < markersArray.length; i++ ) {
  						if(markersArray[i]!=null)
    						markersArray[i].setMap(null);
  					}
  					markersArray=[];
				}
				function setZoom(zoom){
				map.setZoom(zoom);
				}
				function startListen(){
					google.maps.event.addListener(map, 'click', function(event) {
						placeMarker(event.latLng);
					});
				}
				function placeMarker(location) {
						globalInfoWindow.close();
						geocoder.geocode({'latLng': location}, function(results, status) {
						var address;
						if (status == google.maps.GeocoderStatus.OK) {
							if (results[0]) {
								address=results[0].formatted_address;
							}
							else {
								if (results[1]) {
									address=results[1].formatted_address;
								}
							}
						} else {
							address="undefined";
						}
						if ( globalMarker )
							globalMarker.setPosition(location);
						else {
						globalMarker = new google.maps.Marker({
							icon: image,
							shadow: shadow,
							shape: shape,
							position: location,
							map: map
							});
						}
						google.maps.event.addListener(globalMarker, 'click', function () {
							map.setZoom(16);
							map.setCenter(globalMarker.getPosition());
							globalInfoWindow.setContent(address);
							globalInfoWindow.open(map, this);
							});	
						window.document.title="choose#"+location.lat()+"#"+location.lng()+"#"+address;	
						});	  
				}
				
				function codeAddress(address) {
					var coords;
					geocoder.geocode( { 'address': address}, function(results, status) {
					if (status == google.maps.GeocoderStatus.OK && results[0]) {
						coords=results[0].geometry.location;
						window.document.title="address#"+coords.lat()+"#"+coords.lng()+"#"+address;
					} else {
					window.document.title="address#undefined";
					}
					}); 
				}
				
			</script>
		</head>
		<body onload="initialize()">
			<div id="map_canvas" style="width:100%; height:100%"></div>
		</body>
	</html>